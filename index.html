<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket de Compra</title>
    <style>
        * {
            font-family: tahoma, Helvetica, sans-serif;
            font-size: 2mm !important;
            line-height: 1 !important;
        }

        .info-tienda {
            margin-top: 0;
            margin-bottom: 1mm;
            line-height: 4mm;
        }

        .nro_boleta {
            margin: 0;
            font-size: 4mm !important;
        }

        .fecha_recepcion {
            margin: 0;
        }
        .fecha_entrega {
            line-height: 5mm;
            margin: 0;
        }

        .nombre-cliente {
            margin: 2mm;
            margin-top: 0;
            font-size: 3mm !important;
        }

        #thermal-pos {
            box-shadow: 0 0 5mm #eee;
            margin: 0 auto;
            max-width: 79mm;
            padding: 3mm;
        }

        #thermal-pos h2 {
            font-size: 2mm;
            line-height: 13px;
        }
        .label {
            margin: 0;
        }
        #thermal-pos .label {
            text-align: center;
            font-size: 2mm;
        }
        #thermal-pos .line {
            text-align: center;
            line-height: 0;
            font-size: 1mm;
        }

        #thermal-pos .detalles {
            vertical-align: text-top;
            max-width: 35mm;
            word-wrap: break-word;
        }

        #thermal .listitem {
            font-size: 2mm;
            height: 5mm;
        }

        #thermal-pos table {
            font-size: 2mm;
            height: 5mm;
            border-collapse: collapse;
        }

        #thermal-pos .item {
            max-width: 30mm;
            font-size: 2.1mm;
            text-align: start;
            word-wrap: break-word;
        }

        #thermal-pos .cantidad {
            text-align: right;
        }

        #thermal-pos .footer {
            margin-top: 5mm;
            text-align: center;
            height: 60px;
            page-break-after: auto;
        }

        .table {
            width: 100%;
            text-align: right;
        }

        .table-header {
            text-align: right;
            border-top: groove;
            border-bottom: groove;
        }

        .table-header h2 {
            margin: 0;
        }

        .table-item {
            vertical-align: top;
        }

        .top-line {
            border-top: groove;
        }

        .pt-2 {
            padding-top: 2mm;
        }

        .saldo-text {
            margin: 0;
            font-size: 3mm;
            text-align: center;
        }

        .table-footer {
            vertical-align: bottom;
            text-align: right;
            font-size: 2mm;
            line-height: 2mm;
        }

        .table-footer h2 {
            margin: 0;
        }

        .estado-deuda {
            font-size: 3.5mm !important;
        }

        .info {
            font-size: 1.6mm;
        }
        .info p {
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .align-left {
            text-align: left;
        }

        .m-0 {
            margin: 0 !important;
            text-align: left;
        }

        .policy {
            font-size: 1.5mm;
            line-height: 3.5mm;
            padding: 3mm;
            padding-top: 0;
        }

        .policy .policy-title {
            text-align: center;
            margin: 0;
        }

        .align-right {
            text-align: right;
        }

        .button-container {
            display: flex;
            justify-content: center;
        }

        .button-box {
            max-width: 300px;
            display: flex;
            justify-content: space-between;
        }

        .button-box img {
            max-width: 100%;
        }

        @media print {
            #whatsappButton,
            #impresoraButton {
                display: none;
            }

            img#whatsappButton {
                display: none;
            }

            img#impresoraButton {
                display: none;
            }
        }
    </style>
</head>

<body>
    <script>
        const params = new URLSearchParams(window.location.search);

        var nro_boleta = params.has('boleta') ? params.get('boleta') : "---";
        var nombre_cliente = params.has('cliente') ? params.get('cliente') : "==Cliente==";
        var telefono = params.has('telefono') ? params.get('telefono') : "==Cliente==";
        var codigo_pais = params.has('codigo_pais') ? params.get('codigo_pais') : "==Cliente==";
        var fecha = params.has('fecha') ? params.get('fecha') : "dd/mm/aaaa hh:mm:ss";
        var fecha_entrega = params.has('fecha_entrega') ? params.get('fecha_entrega') : "hh:mm:ss";
        var total = params.has('total') ? params.get('total') : "";
        var subtotal_desc = params.has('subtotal_desc') ? params.get('subtotal_desc') : " ";
        var total_a_pagar = params.has('total_a_pagar') ? params.get('total_a_pagar') : " ";
        var descuento = params.has('descuento') ? params.get('descuento') : " ";
        var a_cuenta = params.has('a_cuenta') ? params.get('a_cuenta') : " ";
        var estado = params.has('estado') ? params.get('estado') : "--";

        var cantidades = params.has('cantidades') ? params.get('cantidades') : "";
        var descripciones = params.has('servicios') ? params.get('servicios') : "";
        var detalle = params.has('detalles') ? params.get('detalles') : "";
        var p_units = params.has('p_unit') ? params.get('p_unit') : "";
        var subtotal = params.has('subtotal') ? params.get('subtotal') : "";

        var cantidadespend = params.has('cantidadespend') ? params.get('cantidadespend') : "";
        var serviciospend = params.has('serviciospend') ? params.get('serviciospend') : "";
        var detallespend = params.has('detallespend') ? params.get('detallespend') : "";

        cantidades = cantidades.split(",");
        descripciones = descripciones.split(",");
        detalle = detalle.split(",");
        p_units = p_units.split(",");

        cantidadespend = cantidadespend.split(",");
        serviciospend = serviciospend.split(",");
        detallespend = detallespend.split(",");

        var result = [];
        cantidades.forEach(function(value, id) {
            result[id] = {
                cantidad: cantidades[id],
                descripcion: descripciones[id],
                detalle: detalle[id],
                subtotal: subtotal[id],
                precio_unit: parseFloat(p_units[id]).toFixed(2),
            };
        });

        var resultPend = [];
        cantidadespend.forEach(function(value, id) {
            resultPend[id] = {
                cantidad: cantidadespend[id],
                descripcion: serviciospend[id],
                detalle: detallespend[id],
            };
        });
    </script>

    <div id="header">
        <div class="button-container">
            <div class="button-box">
                <a href="#" id="impresoraButton">
                    <img class="boton" src="Print.png" class="ImganelLogo" width="45%" id="foto">
                </a>
                <a href="#" id="whatsappButton">
                    <img class="boton" src="wsp.png" class="ImganelLogo" width="45%" id="foto">
                </a>
            </div>
        </div>
    </div>

    <div id="thermal-pos">
        <div class="label">
            <img class="boton" src="Easy.png" class="ImganelLogo" width="45%" id="foto">
            <br/>
            <p class="info-tienda">
                Av. Luna Pizarro 505, Vallecito, Arequipa,
                <br>
                Email: facil.laundry@gmail.com
                <br>
                Horario de lunes a sábado de 8:00 am a 5:00 pm pr
                <br>
                <br>
            </p>
        </div>

        <div class="label">
            <b>TICKET:</b>
            <h1 class="nro_boleta" id="nro_boleta_id"></h1>
        </div>
        <div class="label">
            <p class="fecha">
                FECHA DE RECEPCION:
                <br>
                <b id="fecha"></b>
            </p>
            <b>CLIENTE:</b>
            <h1 class="nombre-cliente" id="mesa"></h1>
        </div>
        <div class="label">
            <table class="table">
                <thead class="table-header">
                    <tr>
                        <th class="align-left">
                            <h2>Can</h2>
                        </th>
                        <th class="align-left">
                            <h2>Descripción</h2>
                        </th>
                        <th class="align-left">
                            <h2>Detalle</h2>
                        </th>
                        <th class="align-left">
                            <h2>P. Unit</h2>
                        </th>
                        <th class="align-left">
                            <h2>Subtot</h2>
                        </th>
                    </tr>
                </thead>
                <tbody class="table-item" id="items"></tbody>
                <tfoot class="table-footer" id="totales"></tfoot>
            </table>

            <div>
                <table class="table">
                    <thead class="table-header">
                        <tr>
                            <th class="align-left">
                                <h2>Can</h2>
                            </th>
                            <th class="align-left">
                                <h2>Descripción</h2>
                            </th>
                            <th class="align-left">
                                <h2>Detalle</h2>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="table-item" id="itemsPendientes"></tbody>
                </table>
            </div>
        </div>

        <div class="info">
            <p id="codigo_pais"></p>
            <p id="telefono"></p>
            <p>
                <b> <span id="fecha_entrega_id"></span></b>
            </p>
        </div>
        <div class="footer">
            <p>¡Gracias por su compra!</p>
            <p>Atendido por: <span id="atendido"></span></p>
        </div>
    </div>

    <script>
        var items = document.getElementById("items");
        var itemsPendientes = document.getElementById("itemsPendientes");

        result.forEach(function (item) {
            var tr = document.createElement("tr");
            tr.className = "listitem";
            tr.innerHTML = `<td class="align-left">${item.cantidad}</td>
                <td class="item">${item.descripcion}</td>
                <td class="item">${item.detalle}</td>
                <td class="item">${item.precio_unit}</td>
                <td class="cantidad">${item.subtotal}</td>`;
            items.appendChild(tr);
        });

        resultPend.forEach(function (item) {
            var tr = document.createElement("tr");
            tr.className = "listitem";
            tr.innerHTML = `<td class="align-left">${item.cantidad}</td>
                <td class="item">${item.descripcion}</td>
                <td class="item">${item.detalle}</td>`;
            itemsPendientes.appendChild(tr);
        });

        document.getElementById("nro_boleta_id").innerHTML = nro_boleta;
        document.getElementById("mesa").innerHTML = nombre_cliente;
        document.getElementById("codigo_pais").innerHTML = codigo_pais;
        document.getElementById("telefono").innerHTML = telefono;
        document.getElementById("fecha").innerHTML = fecha;
        document.getElementById("fecha_entrega_id").innerHTML = fecha_entrega;

        var totals = document.getElementById("totales");

        var totalsStr = `<tr class="pt-2">
            <td class="align-left top-line" colspan="4">Descuento:</td>
            <td class="align-right top-line">${descuento}</td>
            </tr>
            <tr>
            <td class="align-left" colspan="4">A Cuenta:</td>
            <td class="align-right">${a_cuenta}</td>
            </tr>
            <tr>
            <td class="align-left estado-deuda" colspan="4">TOTAL A PAGAR:</td>
            <td class="align-right estado-deuda">${total_a_pagar}</td>
            </tr>`;

        totals.innerHTML = totalsStr;
    </script>
</body>
</html>

